# UNION

- 두 개 이상 쿼리 결과의 합집합
- UNION은 결과 집합의 레코드 확장
- c.f.) JOIN은 결과 집합의 컬럼 확장
- 인덱스를 잘 사용해서 최적화한다해도 임시 테이블을 통한 가공 작업이 필요
- 특정 조건을 만족하면 임시 테이블을 통한 가공 작업 없이 쿼리의 결과를 빠르게 가져올 수 있음

# UNION ALL vs UNION DISTINCT

- 두 집합의 중복 제거 여부
  - UNION ALL 은 중복 허용
  - UNION DISTINCT 는 중복 허용 안함(중복 제거 필요)
- UNION ALL 은 여러 결과 집합을 별도로 가공하지 않고 첫 번째 결과셋의 일부 레코드만 찾아도 즉시 클라이언트로 결과를 반환
  (MySQL 서버에 쿼리가 실행되는 도중에 결과를 받기 때문에 병렬 처리가 가능)
- UNION DISTINCT 는 중복 제거를 위해 2개 이상의 컬럼 집합을 먼저 정렬하고 검사해야 함
- UNION DISTINCT 는 임시 테이블에 모든 컬럼으로 구성된 유니크 인덱스도 같이 만듦
  - 결과 집합의 모든 레코드를 순차적으로 루프를 돌면서 유니온 결과 저장용 임시 테이블에 동일한 레코드가 있는지 셀렉트로 체크
  - 결과 값이 있으면 무시하고 없으면 임시 테이블로 인서트
  - 이때, 중복되었다는 판단 기준은 모든 컬럼의 값이 일치하는지 여부를 비교해서 동일 레코드인지 아닌지 판단

# UNION 주의사항

- UNION 키워드만 작성하게 되면 MySQL 서버에서는 DISTINCT가 생략되었다고 판단
