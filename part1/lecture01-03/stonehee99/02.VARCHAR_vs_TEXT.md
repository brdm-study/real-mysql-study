# VARCHAR VS TEXT

지난 시간에 CHAR와 VARCHAR을 비교해봤다면 이번에는 TEXT와 VARCHAR을 비교해보려고 합니다.

## TEXT

TEXT 타입은 대용량 텍스트에 특화된 타입입니다. VARCHAR와 비교하면 같은 텍스트 데이터를 저장하면서, 최대 저장 가능 사이즈도 동일합니다.
지난번 알아본 CHAR와 VARCHAR와 달리 최대 길이를 선언하지 않는다는 특징이 있습니다.

그렇다면 매번 대용량의 레코드를 차지하게 될 수 있어서 MySQL에서 TEXT는 작은 여러 타입으로 나뉘어져 관리됩니다.
`TINYTEXT`는 255바이트 까지의 용량을, `TEXT` 는 최대 64KB의 용량, `MEDIUMTEXT`는 16MB, `LONGTEXT`는 4GB 까지 저장이 가능합니다.

또다른 특징은 VARCHAR을 사용할 때, 단편화현상이 일어났을 때 처럼 TEXT 타입의 컬럼은 애초에 대용량 텍스트라는 가정 하에 사용하는 컬럼이기에 
일반적으로 데이터가 저장되는 페이지 바깥에 저장합니다.

이를 `Off-Page` 라고 하는데요, 테이블의 레코드에는 실제 데이터가 저장된 위치를 가리키는 포인터 (단편화와 비슷하게 동작) 만 포함합니다.

MySQL(InnoDB)은 내부적으로 큰 TEXT 혹은 BLOB 데이터를 저장하기 위해 외부 저장소를 사용하기 때문에 해당 저장소에 저장이되고,
특히 큰 TEXT 데이터 (LONGTEXT) 는 여러 chunk로 분할되어 `Linked-List` 같은 형태의 자료구조로 저장이 되기도 합니다.

따라서 기본적인 B-TREE 구조를 따르고 있지 않기 때문에 인덱스 생성이 제한됩니다.

따라서, TEXT 컬럼에 인덱스를 생성히려면 반드시 Prefix 길이를 지정해야 합니다.

```sql
CREATE INDEX idx_text_column ON table (text_column(100));
```
