# 페이징 쿼리

## LIMIT과 OFFSET을 사용한 페이징 쿼리

백엔드 개발을 하다보면 페이징을 사용하여 데이터를 표시해줘야할 일이 정말 많습니다.

페이징 쿼리를 사용하면 원하는 전체 데이터 길이를 사용자가 필요한 부분만 잘라 조회함으로 효율적으로 데이터를 처리할 수 있습니다.

일반적으로 데이터를 페이징해서 조회한다고 하면 저희는 다음과 같이 쿼리를 작성하곤 합니다.

```sql
SELECT *
FROM users
ORDER BY id
LIMIT 10 OFFSET 10;
```
이 쿼리는 예상한 바와 같이 10번째 데이터를 생략하고 (두번째 페이지 부터) 10개의 데이터를 가져오는 간단한 쿼리입니다.

필요한 데이터를 찾는 개수와 위치를 `LIMIT`, `OFFSET` 을 사용하여 간단하게 나타내곤 하죠.

다만, 이런식의 쿼리는 함정이 있습니다.

```sql
SELECT *
FROM users
ORDER BY id
LIMIT 20 OFFSET 19980;
```
이 쿼리는 어떻게 동작할까요?

원하는 위치의 20개의 데이터만 조회하길 바랬지만, 안타깝게도 데이터베이스는 뛰어넘은 19,980개 데이터를 모두 읽은 후 해당 데이터를 버리고
그 이후 데이터 20개를 찾아내어 반환합니다. 즉 앞의 데이터도 모두 스캔해야하는 것이죠.

페이징 쿼리는 필요한 데이터를 작게 작게 반환하다보니, 모든 데이터를 스캔했을 때보다도 더 자주 쿼리가 실행됩니다. 즉 효율적으로 동작하길 바라며 작성했던 의도와는 달리,
풀 스캔 쿼리를 1번 던졌을 때보다 더 많은 부하가 생기기도 하는 것이죠.

